<?xml version="1.0" encoding="UTF-8"?>
<!--
  TimSquad Service Spec Generator v1.0
  API ëª…ì„¸ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ê³„ì•½ì„œ ì—­í• .
-->
<generator name="service-spec" version="1.0" output=".timsquad/ssot/service-spec.md">
  <metadata>
    <description>ì„œë¹„ìŠ¤ ëª…ì„¸ì„œ (API Specification) ìƒì„±ê¸°</description>
    <purpose>í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ê°„ API ê³„ì•½ ì •ì˜</purpose>
    <depends-on>prd.md, requirements.md</depends-on>
  </metadata>

  <instructions>
    <![CDATA[
    PRDì˜ ê¸°ëŠ¥ ëª©ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

    1. ê° ê¸°ëŠ¥ë³„ë¡œ í•„ìš”í•œ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë„ì¶œ
    2. HTTP ë©”ì„œë“œ, URL, Request/Response ìŠ¤í‚¤ë§ˆ ì •ì˜
    3. ì—ëŸ¬ ì½”ë“œëŠ” error-codes.mdì™€ ì—°ë™

    ì •ì œ ì›ì¹™:
    - RESTful ì»¨ë²¤ì…˜ ì¤€ìˆ˜
    - URL: ì†Œë¬¸ì, ë³µìˆ˜í˜• ëª…ì‚¬ (/users, /matches)
    - ì‘ë‹µ: { success, data, error } í†µì¼ í˜•ì‹
    ]]>
  </instructions>

  <!-- ============================================================
       ì„¹ì…˜ 1: API ê·¸ë£¹ ì •ì˜
       ============================================================ -->
  <section id="api_groups" title="API ê·¸ë£¹" repeatable="true">
    <instructions>
      ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ APIë¥¼ ê·¸ë£¹í•‘í•©ë‹ˆë‹¤.
      ì˜ˆ: Auth, Users, Matches, Messages
    </instructions>

    <field name="group_name" type="text" required="true">
      <prompt>API ê·¸ë£¹ ì´ë¦„? (ì˜ˆ: Auth, Users, Matches)</prompt>
      <refinement>ì˜ë¬¸ ëŒ€ë¬¸ì ì‹œì‘, ë‹¨ìˆ˜/ë³µìˆ˜ ì¼ê´€ì„±</refinement>
    </field>

    <field name="base_path" type="text" required="true">
      <prompt>ê¸°ë³¸ ê²½ë¡œ? (ì˜ˆ: /api/v1/auth)</prompt>
      <auto-suggest>/api/v1/{{group_name | lowercase}}</auto-suggest>
      <refinement>ì†Œë¬¸ì, ë³µìˆ˜í˜•</refinement>
    </field>

    <field name="description" type="text" required="false">
      <prompt>ì´ ê·¸ë£¹ì˜ ì—­í• ?</prompt>
    </field>
  </section>

  <!-- ============================================================
       ì„¹ì…˜ 2: ì—”ë“œí¬ì¸íŠ¸ ì •ì˜ (ê·¸ë£¹ë³„ ë°˜ë³µ)
       ============================================================ -->
  <section id="endpoints" title="ì—”ë“œí¬ì¸íŠ¸" repeatable="true" parent="api_groups">
    <context>í˜„ì¬ ê·¸ë£¹: {{current_group.group_name}}</context>

    <field name="name" type="text" required="true">
      <prompt>ì—”ë“œí¬ì¸íŠ¸ ì´ë¦„? (ì˜ˆ: Login, GetProfile)</prompt>
    </field>

    <field name="method" type="select" required="true">
      <prompt>HTTP ë©”ì„œë“œ?</prompt>
      <options>
        <option value="GET">GET - ì¡°íšŒ</option>
        <option value="POST">POST - ìƒì„±</option>
        <option value="PUT">PUT - ì „ì²´ ìˆ˜ì •</option>
        <option value="PATCH">PATCH - ë¶€ë¶„ ìˆ˜ì •</option>
        <option value="DELETE">DELETE - ì‚­ì œ</option>
      </options>
    </field>

    <field name="path" type="text" required="true">
      <prompt>ê²½ë¡œ? (ì˜ˆ: /login, /:id)</prompt>
      <refinement>
        - íŒŒë¼ë¯¸í„°ëŠ” :id í˜•ì‹
        - ì†Œë¬¸ì, í•˜ì´í”ˆ êµ¬ë¶„
      </refinement>
    </field>

    <field name="description" type="text" required="true">
      <prompt>ì´ APIì˜ ì—­í• ?</prompt>
    </field>

    <field name="auth_required" type="boolean" required="true">
      <prompt>ì¸ì¦ í•„ìš”? (y/n)</prompt>
      <default>true</default>
    </field>

    <field name="request_body" type="schema" required="false">
      <prompt>Request Body í•„ë“œ? (í•„ë“œëª…:íƒ€ì… í˜•ì‹, ì—¬ëŸ¬ ì¤„)</prompt>
      <hint>
        email:string
        password:string
      </hint>
      <skip-if method="GET|DELETE" />
    </field>

    <field name="response_data" type="schema" required="true">
      <prompt>Response data í•„ë“œ?</prompt>
      <hint>
        user:object
        token:string
      </hint>
    </field>

    <field name="errors" type="list" required="false">
      <prompt>ë°œìƒ ê°€ëŠ¥í•œ ì—ëŸ¬ ì½”ë“œ? (ì˜ˆ: AUTH_001, AUTH_002)</prompt>
      <link-to>error-codes.md</link-to>
    </field>
  </section>

  <!-- ============================================================
       ì„¹ì…˜ 3: ê³µí†µ ì •ì˜
       ============================================================ -->
  <section id="common" title="ê³µí†µ ì •ì˜">
    <field name="base_url" type="text" required="true">
      <prompt>API Base URL?</prompt>
      <default>https://api.{{project_name}}.com</default>
    </field>

    <field name="version" type="text" required="true">
      <prompt>API ë²„ì „?</prompt>
      <default>v1</default>
    </field>

    <field name="auth_method" type="select" required="true">
      <prompt>ì¸ì¦ ë°©ì‹?</prompt>
      <options>
        <option value="jwt">JWT Bearer Token</option>
        <option value="session">Session Cookie</option>
        <option value="api_key">API Key</option>
      </options>
      <default>jwt</default>
    </field>
  </section>

  <!-- ============================================================
       ì¶œë ¥ í…œí”Œë¦¿
       ============================================================ -->
  <output-template>
    <![CDATA[
# {{project_name}} ì„œë¹„ìŠ¤ ëª…ì„¸ì„œ

**ìƒì„±ì¼**: {{DATE}}
**ë²„ì „**: {{common.version}}
**Base URL**: `{{common.base_url}}/{{common.version}}`

---

## ê³µí†µ ì‚¬í•­

### ì¸ì¦
- ë°©ì‹: {{common.auth_method | upper}}
{{#if common.auth_method == "jwt"}}
- Header: `Authorization: Bearer <token>`
{{/if}}

### ì‘ë‹µ í˜•ì‹
```json
{
  "success": true,
  "data": { ... },
  "error": null
}
```

### ì—ëŸ¬ ì‘ë‹µ
```json
{
  "success": false,
  "data": null,
  "error": {
    "code": "ERROR_CODE",
    "message": "ì—ëŸ¬ ë©”ì‹œì§€"
  }
}
```

---

{{#each api_groups}}
## {{@index + 1}}. {{group_name}}

> {{description}}

Base Path: `{{base_path}}`

{{#each endpoints where group=group_name}}
### {{@index + 1}}.{{@parent_index + 1}} {{name}}

| í•­ëª© | ê°’ |
|-----|---|
| **URL** | `{{method}} {{../base_path}}{{path}}` |
| **ì„¤ëª…** | {{description}} |
| **ì¸ì¦** | {{#if auth_required}}í•„ìš”{{else}}ë¶ˆí•„ìš”{{/if}} |

{{#if request_body}}
#### Request Body

| Field | Type | Required | Description |
|-------|------|:--------:|-------------|
{{#each request_body}}
| {{name}} | {{type}} | {{#if required}}O{{else}}-{{/if}} | {{description}} |
{{/each}}

```json
{
{{#each request_body}}
  "{{name}}": {{example}}{{#unless @last}},{{/unless}}
{{/each}}
}
```
{{/if}}

#### Response

| Field | Type | Description |
|-------|------|-------------|
{{#each response_data}}
| {{name}} | {{type}} | {{description}} |
{{/each}}

```json
{
  "success": true,
  "data": {
{{#each response_data}}
    "{{name}}": {{example}}{{#unless @last}},{{/unless}}
{{/each}}
  }
}
```

{{#if errors}}
#### Errors

| Code | Description |
|------|-------------|
{{#each errors}}
| {{this}} | â†’ error-codes.md ì°¸ì¡° |
{{/each}}
{{/if}}

---

{{/each}}
{{/each}}

## API ëª©ë¡ ìš”ì•½

| Group | Method | Endpoint | Description | Auth |
|-------|--------|----------|-------------|:----:|
{{#each api_groups}}
{{#each endpoints where group=group_name}}
| {{../group_name}} | {{method}} | {{../base_path}}{{path}} | {{name}} | {{#if auth_required}}ğŸ”’{{else}}-{{/if}} |
{{/each}}
{{/each}}

---

*Generated by TimSquad v2.0*
    ]]>
  </output-template>
</generator>
